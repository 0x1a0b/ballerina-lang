import ballerina/http;
import ballerina/log;
import ballerina/mime;
import ballerina/openapi;
{{#servers}}
listener http:Listener ep{{@index}} = new({{port}}{{#host}}, config = {host: "{{host}}"}{{/host}});
{{/servers}}
@openapi:Service {{=<% %>=}}{<%={{ }}=%>
    contract: "{{definitionPath}}"{{#if tags}},
    tags: [ {{#tags}}{{name}}{{/tags}} ]{{/if}}{{#if operations}},
    operations: [ {{#operations}}{{name}}{{/operations}} ]{{/if}}
}
@http:ServiceConfig {
    basePath: "{{servers.0.basePath}}"{{!-- {{only one base path is allowed for all endpoints}} --}}
}
service {{cut serviceName " "}} on {{#servers}}ep{{@index}}{{#unless @last}}, {{/unless}}{{/servers}} {{=<% %>=}}{<%={{ }}=%>
{{#paths}}{{#operations}}
    @http:ResourceConfig {
        methods:["{{operationType}}"],
        path:"{{pathName}}"{{#requestBody}},
        body:"_{{operationId}}Body"{{/requestBody}}
    }
    resource function {{operationId}} (http:Caller outboundEp, http:Request _{{operationId}}Req{{#if parameters}},{{/if}} {{#parameters}}{{#isPathParam}}{{#paramType}}{{schemaType}}{{/paramType}} {{paramName}}, {{/isPathParam}}{{/parameters}} ) returns error? {{=<% %>=}}{<%={{ }}=%>

    }
{{/operations}}{{/paths}}
}
