apply from: "$rootDir/gradle/javaProject.gradle"
apply plugin: 'com.github.johnrengelman.shadow'

dependencies {
    implementation project(':ballerina-lang')
    implementation project(':ballerina-core')
    implementation project(':ballerina-runtime')
    implementation project(':ballerina-launcher')
    implementation project(':ballerina-backend-jvm')

    implementation 'org.javassist:javassist'
    implementation 'io.netty:netty-codec-http'
    implementation 'org.apache.commons:commons-lang3'
    implementation 'org.wso2.transport.http:org.wso2.transport.http.netty'
    implementation 'org.testng:testng'
}

jar {
    enabled = false
    dependsOn(shadowJar { classifier = null })
    manifest {
        attributes(
                'Implementation-Title': 'Ballerina - Test Utils',
                'Implementation-Version': version,
                'Premain-Class': 'org.ballerinalang.test.agent.BallerinaServerAgent'
        )
    }
}

shadowJar {
    configurations = [project.configurations.runtimeClasspath]
    dependencies {
        exclude('META-INF/*.SF')
        exclude('META-INF/*.DSA')
        exclude('META-INF/*.RSA')
    }
}

build.dependsOn shadowJar

artifacts {
    commonBackend file: file('src/main/ballerina/httpService/common_backend.bal')
}

